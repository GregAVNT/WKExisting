jQuery(document).ready(function(e){if(!e("body").hasClass("post-php")&&!e("body").hasClass("post-new-php"))return;var t=e("#submitdiv").offset();e(window).scroll(function(){var n=e(window).scrollTop();t.top<n+37?e("#submitdiv").addClass("dynamic-fixed"):e("#submitdiv").removeClass("dynamic-fixed")});e("#optional_sections ul input").each(function(){var t=e("#"+e(this).val());this.checked||t.css("display","none")});e("#optional_sections ul input").change(function(){var t=e("#"+e(this).val());this.checked?t.slideDown():t.slideUp()});e("#normal-sortables textarea, #normal-sortables input[type=text]").each(function(){if(e(this).next().hasClass("cmb_metabox_description")){var t=e(this).next().children("span.maxChars")[0];if(t){var n=t.innerText;e(this).next().append('<span class="charCount">'+e(this).val().length+"/"+n+" characters</span>")}}});e("#normal-sortables textarea, #normal-sortables input[type=text]").keyup(function(){if(e(this).next().hasClass("cmb_metabox_description")){var t=e(this).next().children("span.charCount")[0];if(t){var n=e(this).next().children("span.maxChars")[0].innerText,r=e(this).val().length+"/"+n+" characters";e(this).val().length>parseInt(n,10)?t.innerHTML='<span class="charOverflow">'+r+"</span>":t.innerHTML=r}}});e("#normal-sortables input.addField").click(function(t){t.preventDefault();var n=e(this).prev(".sortable"),r=n.find(".infinity_wrapper").last(),i=e(this).parent().find("input.infinity_count"),s=i.val();i.val(++s);var o=i.attr("name").replace("count",""),u=r.clone();u.find("input[type=text], input[type=hidden]").attr("value","");u.find("textarea").empty();u.find("option:selected").removeAttr("selected");u.find(".cmb_media_status").empty();var a=o+"_"+ --s+"_",f=o+"\\["+s+"\\]";u=u.wrap("<p/>").parent().html().replace(new RegExp(a,"g"),o+"_"+ ++s+"_");u=u.replace(new RegExp(f,"g"),o+"["+s+"]");n.append(u)});(function(e){e.fn.saveValues=function(){e(this).each(function(){e(this).attr("value",e(this).val())})}})(jQuery);e("#normal-sortables").on("click","input.removeField",function(t){t.preventDefault();if(e(this).parents(".sortable").find(".infinity_wrapper").length===1){alert("You cannot delete the only element in this section. If you want to exclude this section from this landing page, simply leave these fields blank.");return}var n=confirm("Are you sure you want to delete this?");if(n){var r=e(this).parent().parent().parent().find("input.infinity_count"),i=r.val();r.val(--i);var s=".infinity_wrapper",o=e(this).parent(s),u=o.next(s),a=0,f=o.prev(s);while(f.length){a++;f=f.prev(s)}var l;while(u.length){l=u.clone();l.find("input[type=text]").saveValues();l=l.html().replace(new RegExp("\\["+ ++a+"\\]","g"),"["+(a-1)+"]");l=l.replace(new RegExp("_"+a+"_","g"),"_"+(a-1)+"_");u.html(l);u=u.next(s)}e(this).parents(s).slideUp(400,function(){e(this).remove()})}});e(".cmb_metabox .sortable").sortable({axis:"y",cancel:"input, select, textarea, iframe body",cursor:"move",update:function(t,n){var r=0,i;e(this).children(".infinity_wrapper").each(function(){i=e(this);i.find("input[type=text]").saveValues();i.find("select option:selected").attr("selected","selected");i=i.html().replace(new RegExp("\\[[0-9]+?\\]","g"),"["+r+"]");i=i.replace(new RegExp("_[0-9]+?_","g"),"_"+r+"_");e(this).html(i);++r})}});e("#normal-sortables").on("click","a.cmb_remove_file_button",function(){var t=e(this).parents(".wk-infinity-field");t.find("input[type=hidden]").val("")});e(".meta-box-sortables").sortable({disabled:!0});e(".postbox .hndle").css("cursor","default")});